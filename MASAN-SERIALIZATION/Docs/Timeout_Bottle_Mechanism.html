<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CÆ¡ Cháº¿ Loáº¡i Bá» Chai Bá»‹ Timeout - MASAN Serialization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #fff;
        }

        h1 {
            color: #1a5f7a;
            border-bottom: 3px solid #1a5f7a;
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-size: 28px;
        }

        h2 {
            color: #2d6a4f;
            margin-top: 30px;
            margin-bottom: 15px;
            padding: 10px;
            background: #e8f5e9;
            border-left: 4px solid #2d6a4f;
            font-size: 20px;
        }

        h3 {
            color: #444;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 16px;
        }

        p {
            margin-bottom: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 14px;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }

        th {
            background: #1a5f7a;
            color: white;
        }

        tr:nth-child(even) {
            background: #f9f9f9;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 13px;
            color: #c7254e;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-size: 13px;
            line-height: 1.4;
        }

        pre code {
            background: none;
            color: #f8f8f2;
            padding: 0;
        }

        .toc {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .toc h2 {
            background: none;
            border: none;
            padding: 0;
            margin: 0 0 15px 0;
            color: #1a5f7a;
        }

        .toc ol {
            margin-left: 20px;
        }

        .toc li {
            margin: 5px 0;
        }

        .toc a {
            color: #1a5f7a;
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        .highlight-box {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .success-box {
            background: #d4edda;
            border: 1px solid #28a745;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .error-box {
            background: #f8d7da;
            border: 1px solid #dc3545;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }

        .flowchart {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        .flowchart pre {
            background: #f5f5f5;
            color: #333;
            text-align: left;
        }

        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #ddd;
            text-align: center;
            color: #666;
            font-size: 12px;
        }

        @media print {
            body {
                padding: 20px;
            }

            h2 {
                page-break-after: avoid;
            }

            pre,
            table {
                page-break-inside: avoid;
            }
        }
    </style>
</head>

<body>
    <h1>ğŸ”§ CÆ¡ Cháº¿ Loáº¡i Bá» Chai Bá»‹ Timeout</h1>

    <div class="toc">
        <h2>ğŸ“‘ Má»¥c Lá»¥c</h2>
        <ol>
            <li><a href="#overview">Tá»•ng Quan</a></li>
            <li><a href="#flow">Luá»“ng Xá»­ LÃ½ Camera Sub</a></li>
            <li><a href="#function">HÃ m CheckCameraSubTimeout</a></li>
            <li><a href="#config">Cáº¥u HÃ¬nh Timeout</a></li>
            <li><a href="#database">LÆ°u Trá»¯ Database</a></li>
            <li><a href="#query">CÃ¡ch Query Dá»¯ Liá»‡u Timeout</a></li>
            <li><a href="#diagram">SÆ¡ Äá»“ Flow</a></li>
        </ol>
    </div>

    <h2 id="overview">1. Tá»•ng Quan</h2>

    <p>Há»‡ thá»‘ng cÃ³ cÆ¡ cháº¿ phÃ¡t hiá»‡n vÃ  loáº¡i bá» chai bá»‹ timeout táº¡i <strong>Camera Sub</strong> (Camera phá»¥) dá»±a trÃªn
        viá»‡c <strong>polling Ä‘áº¿m sá»‘ pass tá»« PLC</strong>.</p>

    <h3>NguyÃªn lÃ½ hoáº¡t Ä‘á»™ng:</h3>
    <ul>
        <li>Sau khi gá»­i lá»‡nh pass/reject Ä‘áº¿n PLC, há»‡ thá»‘ng sáº½ liÃªn tá»¥c Ä‘á»c counter tá»« PLC</li>
        <li>Náº¿u pass count <strong>tÄƒng</strong> â†’ PLC Ä‘Ã£ xá»­ lÃ½ thÃ nh cÃ´ng</li>
        <li>Náº¿u pass count <strong>khÃ´ng tÄƒng</strong> trong thá»i gian timeout â†’ Chai bá»‹ timeout, loáº¡i bá»</li>
    </ul>

    <h3>File source code chÃ­nh:</h3>
    <table>
        <tr>
            <th>File</th>
            <th>MÃ´ táº£</th>
        </tr>
        <tr>
            <td><code>Views/Dashboards/FDashboard.cs</code></td>
            <td>Chá»©a logic xá»­ lÃ½ timeout</td>
        </tr>
        <tr>
            <td><code>Production/ProductionHelper.cs</code></td>
            <td>Chá»©a logic lÆ°u database</td>
        </tr>
    </table>

    <h2 id="flow">2. Luá»“ng Xá»­ LÃ½ Camera Sub</h2>

    <h3>2.1 Quy trÃ¬nh xá»­ lÃ½ CameraSub_Process() (dÃ²ng 376-668)</h3>

    <div class="flowchart">
        <pre>
Camera Sub nháº­n mÃ£
       â†“
Kiá»ƒm tra mÃ£ trong Dictionary
       â†“
Kiá»ƒm tra Main_Camera_Status == "1" (Ä‘Ã£ kÃ­ch hoáº¡t tá»« Camera Main)
       â†“
Kiá»ƒm tra duplicate trong CameraSub Dictionary
       â†“
Kiá»ƒm tra thÃ¹ng hiá»‡n táº¡i cÃ³ mÃ£ khÃ´ng
       â†“
Gá»­i lá»‡nh Ä‘áº¿n PLC (Send_To_PLC)
       â†“
[ThÃ nh cÃ´ng] â†’ CheckCameraSubTimeout() â†’ [Timeout?]
       â†“                                       â†“
   [KhÃ´ng Timeout]                      [CÃ³ Timeout]
       â†“                                       â†“
   ThÃªm vÃ o thÃ¹ng                     Loáº¡i bá», ghi record Error
        </pre>
    </div>

    <h3>2.2 Xá»­ lÃ½ khi BackgroundWorker báº­n (dÃ²ng 131-152)</h3>

    <p>Khi <code>subpr.IsBusy</code> (BackgroundWorker Ä‘ang xá»­ lÃ½ mÃ£ khÃ¡c):</p>
    <ul>
        <li>Gá»­i reject xuá»‘ng PLC: <code>Send_To_PLC("PLC_Reject_DM_C1", "0")</code></li>
        <li>ÄÃ¡nh dáº¥u Error: <code>Send_Result_Content_CSub(e_Production_Status.Error, data)</code></li>
        <li>Ghi record: <code>Enqueue_Product_To_Record(data, e_Production_Status.Error, false, ...)</code></li>
    </ul>

    <h2 id="function">3. HÃ m CheckCameraSubTimeout</h2>

    <h3>3.1 Vá»‹ trÃ­: DÃ²ng 1133-1278 trong FDashboard.cs</h3>

    <h3>3.2 Signature:</h3>
    <pre><code>public bool CheckCameraSubTimeout(string productCode, int expectedPassCountIncrease = 1)</code></pre>

    <h3>3.3 Tham sá»‘:</h3>
    <table>
        <tr>
            <th>Tham sá»‘</th>
            <th>MÃ´ táº£</th>
        </tr>
        <tr>
            <td><code>productCode</code></td>
            <td>MÃ£ chai Ä‘ang xá»­ lÃ½</td>
        </tr>
        <tr>
            <td><code>expectedPassCountIncrease</code></td>
            <td>Sá»‘ lÆ°á»£ng pass count mong muá»‘n tÄƒng (máº·c Ä‘á»‹nh = 1)</td>
        </tr>
    </table>

    <h3>3.4 GiÃ¡ trá»‹ tráº£ vá»:</h3>
    <table>
        <tr>
            <th>GiÃ¡ trá»‹</th>
            <th>Ã nghÄ©a</th>
        </tr>
        <tr>
            <td><code>true</code></td>
            <td style="background:#f8d7da;">Chai bá»‹ timeout - cáº§n loáº¡i bá»</td>
        </tr>
        <tr>
            <td><code>false</code></td>
            <td style="background:#d4edda;">Chai xá»­ lÃ½ thÃ nh cÃ´ng - thÃªm vÃ o thÃ¹ng</td>
        </tr>
    </table>

    <h3>3.5 Logic hoáº¡t Ä‘á»™ng:</h3>
    <pre><code>// BÆ°á»›c 1: Kiá»ƒm tra config cÃ³ báº­t timeout khÃ´ng
if (!AppConfigs.Current.CameraSub_Timeout_Enabled)
    return false; // KhÃ´ng timeout - tÃ­nh nÄƒng bá»‹ táº¯t

// BÆ°á»›c 2: LÆ°u snapshot counter trÆ°á»›c khi gá»­i
int passCountBefore = Globals.CameraSub_PLC_Counter.total_pass;

// BÆ°á»›c 3: TÃ­nh sá»‘ láº§n poll
int maxPolls = timeoutMs / pollingIntervalMs;

// BÆ°á»›c 4: XÃ¡c Ä‘á»‹nh Ä‘á»‹a chá»‰ PLC (há»— trá»£ Duo Mode)
string plcAddress = AppConfigs.Current.PLC_Duo_Mode 
    ? PLCAddress.Get("PLC2_Total_Count_DM_C1") 
    : PLCAddress.Get("PLC_Total_Count_DM_C1");

// BÆ°á»›c 5: Polling loop
while (pollCount < maxPolls)
{
    // Äá»c counter tá»« PLC
    OperateResult<int[]> readCheck = PLC.ReadInt32(plcAddress, 5);
    
    if (readCheck.IsSuccess)
    {
        int passCountCurrent = readCheck.Content[2];    // Pass count
        int timeoutCountCurrent = readCheck.Content[3]; // Timeout count
        
        // Kiá»ƒm tra pass count Ä‘Ã£ tÄƒng chÆ°a
        if (passCountCurrent >= passCountBefore + expectedPassCountIncrease)
        {
            return false; // SUCCESS - khÃ´ng timeout
        }
        
        // Kiá»ƒm tra PLC cÃ³ bÃ¡o timeout khÃ´ng
        if (timeoutCountCurrent > Globals.CameraSub_PLC_Counter.timeout)
        {
            return true; // TIMEOUT - PLC bÃ¡o
        }
    }
    
    Thread.Sleep(pollingIntervalMs);
}

// Háº¿t thá»i gian polling â†’ TIMEOUT
return true;</code></pre>

    <h3>3.6 Äá»‹a chá»‰ PLC Ä‘Æ°á»£c Ä‘á»c:</h3>
    <table>
        <tr>
            <th>Index</th>
            <th>Ná»™i dung</th>
        </tr>
        <tr>
            <td><code>Content[0]</code></td>
            <td>Total count - Tá»•ng sá»‘ sáº£n pháº©m</td>
        </tr>
        <tr>
            <td><code>Content[1]</code></td>
            <td>Camera read fail - Sá»‘ sáº£n pháº©m khÃ´ng Ä‘á»c Ä‘Æ°á»£c</td>
        </tr>
        <tr>
            <td><code>Content[2]</code></td>
            <td><strong>Pass count - Sá»‘ sáº£n pháº©m pass</strong></td>
        </tr>
        <tr>
            <td><code>Content[3]</code></td>
            <td><strong>Timeout count - Sá»‘ sáº£n pháº©m timeout</strong></td>
        </tr>
        <tr>
            <td><code>Content[4]</code></td>
            <td>Failed count - Sá»‘ sáº£n pháº©m tháº¥t báº¡i</td>
        </tr>
    </table>

    <h2 id="config">4. Cáº¥u HÃ¬nh Timeout</h2>

    <p>CÃ¡c config trong <code>AppConfigs</code>:</p>

    <table>
        <tr>
            <th>Config</th>
            <th>Kiá»ƒu</th>
            <th>MÃ´ táº£</th>
        </tr>
        <tr>
            <td><code>CameraSub_Timeout_Enabled</code></td>
            <td>bool</td>
            <td>Báº­t/táº¯t tÃ­nh nÄƒng timeout</td>
        </tr>
        <tr>
            <td><code>CameraSub_Timeout_Ms</code></td>
            <td>int</td>
            <td>Thá»i gian timeout (ms)</td>
        </tr>
        <tr>
            <td><code>CameraSub_Polling_Interval_Ms</code></td>
            <td>int</td>
            <td>Khoáº£ng thá»i gian giá»¯a cÃ¡c láº§n poll (ms)</td>
        </tr>
        <tr>
            <td><code>CameraSub_Timeout_Log_Enabled</code></td>
            <td>bool</td>
            <td>Báº­t/táº¯t log chi tiáº¿t timeout</td>
        </tr>
        <tr>
            <td><code>PLC_Duo_Mode</code></td>
            <td>bool</td>
            <td>Cháº¿ Ä‘á»™ 2 PLC</td>
        </tr>
    </table>

    <h3>VÃ­ dá»¥ cáº¥u hÃ¬nh:</h3>
    <pre><code>{
    "CameraSub_Timeout_Enabled": true,
    "CameraSub_Timeout_Ms": 500,
    "CameraSub_Polling_Interval_Ms": 10,
    "CameraSub_Timeout_Log_Enabled": true,
    "PLC_Duo_Mode": false
}</code></pre>

    <div class="highlight-box">
        <strong>ğŸ“Š TÃ­nh toÃ¡n:</strong><br>
        Sá»‘ láº§n poll tá»‘i Ä‘a = 500ms / 10ms = <strong>50 láº§n</strong><br>
        Náº¿u sau 50 láº§n poll mÃ  pass count khÃ´ng tÄƒng â†’ <strong>Timeout</strong>
    </div>

    <h2 id="database">5. LÆ°u Trá»¯ Database</h2>

    <h3>5.1 File Database:</h3>
    <pre><code>Record_CameraSub_{orderNo}.db</code></pre>

    <p><strong>ÄÆ°á»ng dáº«n Ä‘áº§y Ä‘á»§:</strong></p>
    <pre><code>C:\MasanSerialization\Databases\{yyyy-MM}\{GTIN}\Record_CameraSub_{orderNo}.db</code></pre>

    <h3>5.2 Báº£ng: Records_CameraSub</h3>

    <table>
        <tr>
            <th>Cá»™t</th>
            <th>Kiá»ƒu</th>
            <th>MÃ´ táº£</th>
            <th>GiÃ¡ trá»‹ khi Timeout</th>
        </tr>
        <tr>
            <td><code>ID</code></td>
            <td>INTEGER</td>
            <td>ID tá»± tÄƒng</td>
            <td>Auto</td>
        </tr>
        <tr>
            <td><code>Code</code></td>
            <td>TEXT</td>
            <td>MÃ£ chai</td>
            <td>MÃ£ chai bá»‹ timeout</td>
        </tr>
        <tr>
            <td><code>cartonID</code></td>
            <td>INTEGER</td>
            <td>ID thÃ¹ng</td>
            <td style="background:#f8d7da;"><strong>0</strong></td>
        </tr>
        <tr>
            <td><code>Status</code></td>
            <td>TEXT</td>
            <td>Tráº¡ng thÃ¡i</td>
            <td style="background:#f8d7da;"><strong>"Error"</strong></td>
        </tr>
        <tr>
            <td><code>PLC_Status</code></td>
            <td>TEXT</td>
            <td>Tráº¡ng thÃ¡i PLC</td>
            <td style="background:#f8d7da;"><strong>"False"</strong></td>
        </tr>
        <tr>
            <td><code>ActivateDate</code></td>
            <td>TEXT</td>
            <td>Thá»i gian xá»­ lÃ½</td>
            <td>Timestamp</td>
        </tr>
        <tr>
            <td><code>ActivateUser</code></td>
            <td>TEXT</td>
            <td>User Ä‘ang cháº¡y</td>
            <td>Username</td>
        </tr>
        <tr>
            <td><code>ProductionDate</code></td>
            <td>TEXT</td>
            <td>NgÃ y sáº£n xuáº¥t</td>
            <td>Production date</td>
        </tr>
    </table>

    <h3>5.3 HÃ m lÆ°u database:</h3>
    <p><strong>File:</strong> <code>Production/ProductionHelper.cs</code> - DÃ²ng 1710-1730</p>
    <pre><code>public void Insert_Record_Camera_Sub(ProductionCodeData_Record record, string orderNo)
{
    string czRunPath = $"{GetOrderBasePath(orderNo)}/Record_CameraSub_{orderNo}.db";
    
    string query = @"INSERT INTO Records_CameraSub 
        (Code, cartonID, Status, PLC_Status, ActivateDate, ActivateUser, ProductionDate) 
        VALUES (@Code, @cartonID, @Status, @PLC_Status, @ActivateDate, @ActivateUser, @ProductionDate)";
    
    // Execute insert...
}</code></pre>

    <h2 id="query">6. CÃ¡ch Query Dá»¯ Liá»‡u Timeout</h2>

    <h3>6.1 Query táº¥t cáº£ chai Timeout:</h3>
    <pre><code>SELECT * FROM Records_CameraSub 
WHERE Status = 'Error'</code></pre>

    <h3>6.2 Query chai Timeout vá»›i Ä‘iá»u kiá»‡n chi tiáº¿t:</h3>
    <pre><code>SELECT * FROM Records_CameraSub 
WHERE Status = 'Error' 
  AND PLC_Status = 'False' 
  AND cartonID = 0</code></pre>

    <h3>6.3 Äáº¿m sá»‘ chai Timeout theo ngÃ y:</h3>
    <pre><code>SELECT DATE(ActivateDate) as Date, COUNT(*) as TimeoutCount
FROM Records_CameraSub 
WHERE Status = 'Error'
GROUP BY DATE(ActivateDate)
ORDER BY Date DESC</code></pre>

    <h3>6.4 Query chi tiáº¿t vá»›i thá»i gian:</h3>
    <pre><code>SELECT 
    Code,
    ActivateDate,
    ActivateUser,
    ProductionDate
FROM Records_CameraSub 
WHERE Status = 'Error'
  AND ActivateDate BETWEEN '2026-01-01' AND '2026-01-31'
ORDER BY ActivateDate DESC</code></pre>

    <h2 id="diagram">7. SÆ¡ Äá»“ Flow</h2>

    <div class="flowchart">
        <pre style="font-size: 12px;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CAMERA SUB TIMEOUT FLOW                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Camera Sub nháº­n mÃ£  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     KhÃ´ng
    â”‚ MÃ£ cÃ³ trong          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Dictionary?          â”‚                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â–¼
               â”‚ CÃ³                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â–¼                     â”‚   REJECT    â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  NotFound   â”‚
    â”‚ Main_Camera_Status   â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ == "1" ?             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ CÃ³
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     CÃ³
    â”‚ ÄÃ£ scan bá»Ÿi          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CameraSub?           â”‚                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â–¼
               â”‚ KhÃ´ng               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â–¼                     â”‚   REJECT    â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  Duplicate  â”‚
    â”‚ Gá»­i lá»‡nh Ä‘áº¿n PLC     â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     Tháº¥t báº¡i
    â”‚ Gá»­i PLC thÃ nh cÃ´ng?  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
               â”‚ ThÃ nh cÃ´ng                 â–¼
               â–¼                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    ERROR    â”‚
    â”‚ CheckCameraSubTimeoutâ”‚         â”‚  PLC Fail   â”‚
    â”‚ (Polling PLC Counter)â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
          â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
          â–¼         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ TIMEOUT  â”‚  â”‚        KHÃ”NG TIMEOUT         â”‚
    â”‚          â”‚  â”‚                              â”‚
    â”‚ âŒ Error  â”‚  â”‚ âœ… Pass - ThÃªm vÃ o thÃ¹ng     â”‚
    â”‚ cartonID â”‚  â”‚ cartonID = X                 â”‚
    â”‚ = 0      â”‚  â”‚                              â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         LÆ¯U VÃ€O DATABASE               â”‚
    â”‚    Records_CameraSub_{orderNo}.db      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        </pre>
    </div>

    <h2>Phá»¥ Lá»¥c</h2>

    <h3>A. CÃ¡c tráº¡ng thÃ¡i sáº£n pháº©m (e_Production_Status):</h3>
    <table>
        <tr>
            <th>Enum</th>
            <th>MÃ´ táº£</th>
        </tr>
        <tr>
            <td><code>Pass</code></td>
            <td style="background:#d4edda;">Sáº£n pháº©m OK</td>
        </tr>
        <tr>
            <td><code>Error</code></td>
            <td style="background:#f8d7da;">Lá»—i (bao gá»“m timeout)</td>
        </tr>
        <tr>
            <td><code>Duplicate</code></td>
            <td style="background:#fff3cd;">MÃ£ trÃ¹ng</td>
        </tr>
        <tr>
            <td><code>NotFound</code></td>
            <td style="background:#f8d7da;">KhÃ´ng tÃ¬m tháº¥y mÃ£</td>
        </tr>
        <tr>
            <td><code>ReadFail</code></td>
            <td style="background:#f8d7da;">Camera khÃ´ng Ä‘á»c Ä‘Æ°á»£c mÃ£</td>
        </tr>
    </table>

    <h3>B. Äá»‹a chá»‰ PLC liÃªn quan:</h3>
    <table>
        <tr>
            <th>Äá»‹a chá»‰ Config</th>
            <th>MÃ´ táº£</th>
        </tr>
        <tr>
            <td><code>PLC_Reject_DM_C1</code></td>
            <td>Äá»‹a chá»‰ reject Camera Sub (PLC 1)</td>
        </tr>
        <tr>
            <td><code>PLC2_Reject_DM_C1</code></td>
            <td>Äá»‹a chá»‰ reject Camera Sub (PLC 2)</td>
        </tr>
        <tr>
            <td><code>PLC_Total_Count_DM_C1</code></td>
            <td>Äá»‹a chá»‰ counter Camera Sub (PLC 1)</td>
        </tr>
        <tr>
            <td><code>PLC2_Total_Count_DM_C1</code></td>
            <td>Äá»‹a chá»‰ counter Camera Sub (PLC 2)</td>
        </tr>
    </table>

    <h3>C. GiÃ¡ trá»‹ gá»­i PLC:</h3>
    <table>
        <tr>
            <th>GiÃ¡ trá»‹</th>
            <th>Ã nghÄ©a</th>
        </tr>
        <tr>
            <td><code>0</code></td>
            <td style="background:#f8d7da;">Reject - Loáº¡i bá» chai</td>
        </tr>
        <tr>
            <td><code>1</code></td>
            <td style="background:#d4edda;">Pass - PhÃ¢n lÃ n láº»</td>
        </tr>
        <tr>
            <td><code>2</code></td>
            <td style="background:#d4edda;">Pass - PhÃ¢n lÃ n cháºµn</td>
        </tr>
    </table>

    <div class="footer">
        <p><strong>PhiÃªn báº£n:</strong> 1.0 | <strong>NgÃ y táº¡o:</strong> 2026-01-11</p>
        <p><strong>File nguá»“n:</strong> FDashboard.cs, ProductionHelper.cs</p>
        <p>MASAN Serialization System</p>
    </div>
</body>

</html>