<!DOCTYPE html>
<html lang="en" style="height: 100%">
<head>
  <meta charset="utf-8">
  <title>Pie Chart Template - Offline</title>
</head>
<body style="height: 100%; margin: 0">
  <div id="container" style="height: 100%"></div>

  <!-- Using offline ECharts from node_modules -->
  <script type="text/javascript" src="node_modules/echarts/dist/echarts.min.js"></script>
  
  <script type="text/javascript">
    var dom = document.getElementById('container');
    var myChart = echarts.init(dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    var app = {};
    
    var option;

    // Default template option - will be replaced by C#
    option = {
      title: {
        text: 'Pie Chart Template',
        left: 'center'
      },
      tooltip: {
        trigger: 'item',
        formatter: '{a} <br/>{b}: {c} ({d}%)'
      },
      legend: {
        orient: 'vertical',
        left: 'left',
        data: ['Series 1', 'Series 2', 'Series 3']
      },
      toolbox: {
        show: true,
        orient: 'vertical',
        left: 'right',
        top: 'center',
        feature: {
          mark: { show: true },
          dataView: { show: true, readOnly: false },
          restore: { show: true },
          saveAsImage: { show: true }
        }
      },
      series: [
        {
          name: 'Data',
          type: 'pie',
          radius: '50%',
          center: ['50%', '60%'],
          data: [
            { value: 335, name: 'Series 1' },
            { value: 310, name: 'Series 2' },
            { value: 234, name: 'Series 3' }
          ],
          emphasis: {
            itemStyle: {
              shadowBlur: 10,
              shadowOffsetX: 0,
              shadowColor: 'rgba(0, 0, 0, 0.5)'
            }
          },
          itemStyle: {
            color: function(params) {
              var colorList = ['#5470c6', '#91cc75', '#fac858', '#ee6666', '#73c0de'];
              return colorList[params.dataIndex % colorList.length];
            }
          }
        }
      ]
    };

    if (option && typeof option === 'object') {
      myChart.setOption(option);
    }

    window.addEventListener('resize', myChart.resize);
    
    // Global functions for C# interaction
    window.updateChart = function(newOption) {
      if (myChart) {
        myChart.setOption(newOption, true);
      }
    };
    
    window.getChartOption = function() {
      return myChart ? myChart.getOption() : null;
    };
    
    window.exportChart = function(type) {
      return myChart ? myChart.getDataURL({
        type: type || 'png',
        pixelRatio: 2,
        backgroundColor: '#fff'
      }) : null;
    };
    
    // Notify parent that chart is ready
    window.chartReady = true;
    console.log('Pie Chart initialized successfully');
  </script>
</body>
</html>